(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{262:function(_,v,t){"use strict";t.r(v);var e=t(28),r=Object(e.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"限流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限流"}},[_._v("#")]),_._v(" 限流")]),_._v(" "),t("h2",{attrs:{id:"什么是限流？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是限流？"}},[_._v("#")]),_._v(" 什么是限流？")]),_._v(" "),t("p",[_._v("限流可以认为服务降级的一种，限流就是限制系统的输入和输出流量已达到保护系统的目的。")]),_._v(" "),t("p",[_._v("一般来说系统的吞吐量是可以被测算的，为了保证系统的稳定运行，"),t("br"),_._v("\n一旦达到的需要限制的阈值，就需要限制流量并采取一些措施以完成限制流量的目的。")]),_._v(" "),t("p",[_._v("比如：延迟处理，拒绝处理，或者部分拒绝处理等等。")]),_._v(" "),t("h2",{attrs:{id:"限流的方法有哪些？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限流的方法有哪些？"}},[_._v("#")]),_._v(" 限流的方法有哪些？")]),_._v(" "),t("ul",[t("li",[_._v("计数器")])]),_._v(" "),t("p",[_._v("控制单位时间内的请求数量")]),_._v(" "),t("p",[_._v("问题："),t("br"),_._v("\n假设在 00:01 时发生一个请求，在 00:01-00:58 之间不在发送请求，"),t("br"),_._v("\n在 00:59 时发送剩下的所有请求 n-1 (n为限流请求数量)，"),t("br"),_._v("\n在下一分钟的 00:01 发送n个请求，这样在2秒钟内请求到达了 2n - 1 个。")]),_._v(" "),t("ul",[t("li",[_._v("滑动窗口")])]),_._v(" "),t("p",[_._v("滑动窗口是对计数器方式的改进, 增加一个时间粒度的度量单位。"),t("br"),_._v("\n把一分钟分成若干等分(6份,每份10秒)，在每一份上设置独立计数器，在 00:00-00:09 之间发生请求计数器累加1。"),t("br"),_._v("\n当等分数量越大限流统计就越详细。")]),_._v(" "),t("ul",[t("li",[_._v("Leaky Bucket 漏桶")])]),_._v(" "),t("p",[_._v("规定固定容量的桶，有水进入，有水流出。"),t("br"),_._v("\n对于流进的水我们无法估计进来的数量、速度， 对于流出的水我们可以控制速度。")]),_._v(" "),t("ul",[t("li",[_._v("Token Bucket 令牌桶")])]),_._v(" "),t("p",[_._v("规定固定容量的桶，token 以固定速度往桶内填充，"),t("br"),_._v("\n当桶满时 token 不会被继续放入，每过来一个请求把 token 从桶中移除，如果桶中没有 token 不能请求。")]),_._v(" "),t("h2",{attrs:{id:"有哪些限流开源实现方式？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#有哪些限流开源实现方式？"}},[_._v("#")]),_._v(" 有哪些限流开源实现方式？")]),_._v(" "),t("ul",[t("li",[_._v("Spring Cloud Gateway")])]),_._v(" "),t("p",[_._v("默认使用redis进行限流。")]),_._v(" "),t("ul",[t("li",[_._v("sentinel")])]),_._v(" "),t("p",[_._v("通过配置来控制每个url的流量，滑动窗口算法。")]),_._v(" "),t("ul",[t("li",[_._v("Nginx")])]),_._v(" "),t("p",[_._v("连接数限流模块（ngx_http_limit_conn_module）"),t("br"),_._v("\n漏桶算法实现的请求限流模块（ngx_http_limit_req_module）")]),_._v(" "),t("ul",[t("li",[_._v("OpenResty")])]),_._v(" "),t("p",[_._v("lua-resty-limit-traffic")]),_._v(" "),t("ul",[t("li",[_._v("Guava RateLimiter")])]),_._v(" "),t("p",[_._v("采用令牌桶算法")])])}),[],!1,null,null,null);v.default=r.exports}}]);