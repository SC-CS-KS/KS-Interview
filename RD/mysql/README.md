# MySQL

## 数据常用存储方式？   

顺序存储和链式存储    

## 事务有时候需要手动提交，容易忘记，Java代码使用什么方式可以实现自动提交（commit）？  

try-with-resource。  

## Mysql如果一个事务一直没有commit并且也没有rollback会怎样？  

断开链接会自动rollback，死锁或者这个锁超时的时候，也会rollback。    

## 索引实现原理？ 

* B+树  


## 文件存储要选用B+树这样的数据结构？  

* B+  tree 的磁盘读写代价更低  
内部结点并没有指向关键字具体信息的指针，因此其内部结点相对B 树更小。  
如果把所有同一内部结点的关键字存放在同一盘块中，那么盘块所能容纳的关键字数量也越多。  
一次性读入内存中的需要查找的关键字也就越多，相对来说IO读写次数也就降低了。  

* B+ tree 的查询效率更加稳定  
由于非终结点并不是最终指向文件内容的结点，而只是叶子结点中关键字的索引，  
所以任何关键字的查找必须走一条从根结点到叶子结点的路，  
所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。  

## MySQL为什么选取B+树?

本质上是因为MySQL数据是存放在外部存储的  
B+树是为磁盘或其他直接存取的辅助存储设备而设计的一种数据结构。  

能够提供稳定高效的范围扫描（range-query）功能  
这也是为什么数据库和操作系统中的文件系统通常会采用b+树作为数据索引的原因  
这个特点主要因为所有叶子节点相互连接，并且叶子节点本身依关键字的大小自小而大顺序链接。  

## 怎样实现有条件的索引?

例如：  
有A、B两列，B为一个状态列取值 0 和1，要求当B = 1时，AB为唯一索引，而等于 0 时，可以任意存储。  


## 怎样在 MySQL 表中存储树形结构数据？  

1. Adjacency List：每一条记录存parent_id。  
2. Path Enumerations：每一条记录存整个tree path经过的node枚举。  
3. Nested Sets：每一条记录存 nleft 和 nright。  
4. Closure Table：维护一个表，所有的 tree path 作为记录进行保存。  
